<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TravelEase • Smart Travel & Booking</title>
  <meta name="description" content="Search, compare, and book flights, trains, cars, and hotels with a modern, responsive experience.">
  
  <script src="https://cdn.tailwindcss.com"></script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <script src="https://unpkg.com/lucide@latest"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 900: '#1e3a8a' },
            slateBg: '#0f172a',
          },
          boxShadow: {
            'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.15)',
            'card': '0 10px 40px -10px rgba(0,0,0,0.08)',
          }
        }
      }
    }
  </script>

  <style>
    /* Custom Styles & Animations */
    body { background-color: #f8fafc; color: #0f172a; }
    
    .glass-panel {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.5);
    }

    .hero-bg {
      background: radial-gradient(at 0% 0%, rgba(59, 130, 246, 0.5) 0px, transparent 50%),
                  radial-gradient(at 100% 0%, rgba(37, 99, 235, 0.3) 0px, transparent 50%),
                  linear-gradient(to bottom right, #0f172a, #1e293b);
    }

    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; opacity: 0; transform: translateY(20px); }
    @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

    .modal-enter { animation: modalIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    @keyframes modalIn {
      from { opacity: 0; transform: scale(0.95) translateY(10px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    /* Custom Checkbox */
    .checkbox-wrapper input:checked + div { background-color: #2563eb; border-color: #2563eb; }
    .checkbox-wrapper input:checked + div svg { display: block; }
  </style>
</head>
<body class="min-h-screen flex flex-col antialiased selection:bg-brand-100 selection:text-brand-900">

  <nav class="sticky top-0 z-50 glass-panel border-b border-slate-200/60 shadow-sm transition-all duration-300" id="navbar">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center gap-2 cursor-pointer group" onclick="app.scrollTo('hero')">
          <div class="w-8 h-8 bg-brand-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-brand-500/30 group-hover:scale-105 transition-transform">
            <i data-lucide="plane" class="w-5 h-5"></i>
          </div>
          <span class="font-bold text-xl tracking-tight text-slate-800">Travel<span class="text-brand-600">Ease</span></span>
        </div>

        <div class="hidden md:flex items-center gap-8 font-medium text-sm text-slate-600">
          <button onclick="app.scrollTo('hero')" class="hover:text-brand-600 transition-colors">Home</button>
          <button onclick="app.scrollTo('features')" class="hover:text-brand-600 transition-colors">Explore</button>
          <button onclick="app.scrollTo('mytrips')" class="hover:text-brand-600 transition-colors">My Trips</button>
          <button onclick="app.scrollTo('footer')" class="hover:text-brand-600 transition-colors">Support</button>
        </div>

        <div class="flex items-center gap-3">
          <div id="user-display" class="hidden flex items-center gap-2 bg-slate-100 px-3 py-1.5 rounded-full border border-slate-200">
            <div class="w-6 h-6 rounded-full bg-brand-100 text-brand-600 flex items-center justify-center text-xs font-bold" id="user-avatar">U</div>
            <span class="text-xs font-semibold text-slate-700 max-w-[100px] truncate" id="user-name">User</span>
          </div>
          
          <a id="auth-btn" href="signin.html" class="bg-slate-900 text-white px-5 py-2 rounded-full text-sm font-semibold shadow-lg shadow-slate-900/20 hover:bg-slate-800 hover:-translate-y-0.5 transition-all">
            Sign In
          </a>
        </div>
      </div>
    </div>
  </nav>

  <header id="hero" class="relative hero-bg pt-12 pb-24 lg:pt-20 lg:pb-32 overflow-hidden">
    <div class="absolute top-0 right-0 -mr-20 -mt-20 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"></div>
    <div class="absolute bottom-0 left-0 -ml-20 -mb-20 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"></div>

    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid lg:grid-cols-12 gap-12 items-center">
      
      <div class="lg:col-span-6 text-center lg:text-left space-y-6 fade-in-up" style="animation-delay: 0.1s;">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-900/30 border border-blue-500/30 text-blue-100 text-xs font-semibold uppercase tracking-wider">
          <span class="w-2 h-2 rounded-full bg-blue-400 animate-pulse"></span>
          Live Inventory Demo
        </div>
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold text-white leading-tight">
          Discover the real <br>
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-indigo-200">India & Beyond</span>
        </h1>
        <p class="text-lg text-blue-100/80 max-w-2xl mx-auto lg:mx-0 leading-relaxed">
          Compare prices across flights, trains, and hotels. Book instantly with our secure platform. No hidden fees, just travel.
        </p>
        
        <div class="flex flex-wrap justify-center lg:justify-start gap-4 pt-2 text-white/90 font-medium text-sm">
          <div class="flex items-center gap-2"><i data-lucide="check-circle" class="w-4 h-4 text-emerald-400"></i> Instant Confirmation</div>
          <div class="flex items-center gap-2"><i data-lucide="shield-check" class="w-4 h-4 text-emerald-400"></i> Secure & Private</div>
          <div class="flex items-center gap-2"><i data-lucide="zap" class="w-4 h-4 text-emerald-400"></i> Best Price Guarantee</div>
        </div>
      </div>

      <div class="lg:col-span-6 fade-in-up" style="animation-delay: 0.3s;">
        <div class="glass-panel rounded-2xl p-2 shadow-2xl shadow-blue-900/20">
          <div class="bg-white rounded-xl p-5 md:p-6">
            
            <div class="grid grid-cols-4 gap-1 p-1 bg-slate-100 rounded-xl mb-6">
              <button onclick="app.setMode('flight')" class="search-tab active-tab flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-semibold transition-all" data-mode="flight">
                <i data-lucide="plane" class="w-4 h-4"></i> <span class="hidden sm:inline">Flights</span>
              </button>
              <button onclick="app.setMode('train')" class="search-tab flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-semibold text-slate-500 hover:bg-white/50 transition-all" data-mode="train">
                <i data-lucide="train" class="w-4 h-4"></i> <span class="hidden sm:inline">Trains</span>
              </button>
              <button onclick="app.setMode('car')" class="search-tab flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-semibold text-slate-500 hover:bg-white/50 transition-all" data-mode="car">
                <i data-lucide="car" class="w-4 h-4"></i> <span class="hidden sm:inline">Cabs</span>
              </button>
              <button onclick="app.setMode('hotel')" class="search-tab flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-semibold text-slate-500 hover:bg-white/50 transition-all" data-mode="hotel">
                <i data-lucide="bed" class="w-4 h-4"></i> <span class="hidden sm:inline">Stays</span>
              </button>
            </div>

            <form onsubmit="app.handleSearch(event)" class="space-y-4">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="relative group">
                  <label class="block text-xs font-semibold text-slate-500 mb-1 ml-1" id="label-from">From</label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i data-lucide="map-pin" class="h-4 w-4 text-slate-400 group-focus-within:text-brand-500 transition-colors"></i>
                    </div>
                    <input type="text" id="input-from" class="block w-full pl-10 pr-3 py-3 border border-slate-200 rounded-xl leading-5 bg-slate-50 placeholder-slate-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all font-medium sm:text-sm" placeholder="City or Airport" required>
                  </div>
                </div>

                <div class="relative group" id="field-to">
                  <label class="block text-xs font-semibold text-slate-500 mb-1 ml-1" id="label-to">To</label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i data-lucide="map" class="h-4 w-4 text-slate-400 group-focus-within:text-brand-500 transition-colors"></i>
                    </div>
                    <input type="text" id="input-to" class="block w-full pl-10 pr-3 py-3 border border-slate-200 rounded-xl leading-5 bg-slate-50 placeholder-slate-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all font-medium sm:text-sm" placeholder="City or Station">
                  </div>
                </div>
              </div>

              <div class="grid grid-cols-2 gap-4">
                <div class="relative group">
                  <label class="block text-xs font-semibold text-slate-500 mb-1 ml-1">Date</label>
                  <div class="relative">
                    <input type="date" id="input-date" class="block w-full px-3 py-3 border border-slate-200 rounded-xl leading-5 bg-slate-50 text-slate-600 focus:outline-none focus:bg-white focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all font-medium sm:text-sm" required>
                  </div>
                </div>

                <div class="relative group">
                  <label class="block text-xs font-semibold text-slate-500 mb-1 ml-1">Travelers</label>
                  <div class="relative">
                    <input type="number" id="input-pax" min="1" max="10" value="1" class="block w-full px-3 py-3 border border-slate-200 rounded-xl leading-5 bg-slate-50 text-slate-600 focus:outline-none focus:bg-white focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all font-medium sm:text-sm">
                  </div>
                </div>
              </div>

              <button type="submit" class="w-full mt-4 bg-brand-600 hover:bg-brand-700 text-white font-bold py-3.5 px-4 rounded-xl shadow-lg shadow-brand-500/30 hover:shadow-brand-500/50 transform active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                <i data-lucide="search" class="w-5 h-5"></i>
                <span id="search-btn-text">Search Availability</span>
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </header>

  <section id="features" class="bg-white border-b border-slate-100 py-10 overflow-x-hidden">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-lg font-bold text-slate-800">Trending Now</h2>
        <div class="flex gap-2">
          <button class="w-8 h-8 rounded-full border border-slate-200 flex items-center justify-center hover:bg-slate-50 transition"><i data-lucide="chevron-left" class="w-4 h-4 text-slate-600"></i></button>
          <button class="w-8 h-8 rounded-full border border-slate-200 flex items-center justify-center hover:bg-slate-50 transition"><i data-lucide="chevron-right" class="w-4 h-4 text-slate-600"></i></button>
        </div>
      </div>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="group relative rounded-xl overflow-hidden aspect-[4/3] cursor-pointer shadow-md">
          <img src="https://images.unsplash.com/photo-1524492412937-b28074a5d7da?auto=format&fit=crop&w=600&q=80" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Taj Mahal">
          <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
          <div class="absolute bottom-3 left-3 text-white">
            <p class="text-xs font-medium text-white/80">Agra</p>
            <p class="font-bold">Taj Mahal</p>
          </div>
        </div>
        <div class="group relative rounded-xl overflow-hidden aspect-[4/3] cursor-pointer shadow-md">
          <img src="https://images.unsplash.com/photo-1512343879784-a960bf40e7f2?auto=format&fit=crop&w=600&q=80" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Goa">
          <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
          <div class="absolute bottom-3 left-3 text-white">
            <p class="text-xs font-medium text-white/80">Goa</p>
            <p class="font-bold">Palolem Beach</p>
          </div>
        </div>
        <div class="group relative rounded-xl overflow-hidden aspect-[4/3] cursor-pointer shadow-md">
          <img src="https://images.unsplash.com/photo-1587474260584-136574528ed5?auto=format&fit=crop&w=600&q=80" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Delhi">
          <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
          <div class="absolute bottom-3 left-3 text-white">
            <p class="text-xs font-medium text-white/80">Delhi</p>
            <p class="font-bold">India Gate</p>
          </div>
        </div>
        <div class="group relative rounded-xl overflow-hidden aspect-[4/3] cursor-pointer shadow-md">
          <img src="https://images.unsplash.com/photo-1596422846543-75c6fc197f07?auto=format&fit=crop&w=600&q=80" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="Jaipur">
          <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
          <div class="absolute bottom-3 left-3 text-white">
            <p class="text-xs font-medium text-white/80">Jaipur</p>
            <p class="font-bold">Hawa Mahal</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="results-section" class="py-12 bg-slate-50 min-h-[400px] hidden">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-end justify-between mb-8">
        <div>
          <h2 class="text-2xl font-bold text-slate-800">Available Options</h2>
          <p class="text-slate-500 mt-1">Based on your search criteria</p>
        </div>
        <div class="text-xs text-slate-400 font-medium bg-white px-3 py-1 rounded-full border border-slate-200">
          Showing 4 best results
        </div>
      </div>
      
      <div id="results-grid" class="grid grid-cols-1 gap-5">
        </div>
    </div>
  </section>

  <section id="mytrips" class="py-16 bg-white relative">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-10">
        <h2 class="text-3xl font-bold text-slate-900">Your Journeys</h2>
        <p class="text-slate-500 mt-2">Manage your upcoming and past trips.</p>
      </div>
      
      <div id="bookings-container" class="space-y-4 min-h-[200px]">
        <div class="text-center py-12 bg-slate-50 rounded-2xl border-2 border-dashed border-slate-200">
          <div class="mx-auto w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4">
            <i data-lucide="map" class="w-8 h-8 text-slate-300"></i>
          </div>
          <h3 class="text-lg font-medium text-slate-900">No trips booked yet</h3>
          <p class="text-slate-500 text-sm mt-1 mb-4">Time to start planning your next adventure!</p>
          <button onclick="app.scrollTo('hero')" class="text-brand-600 font-semibold hover:underline">Start Searching</button>
        </div>
      </div>
    </div>
  </section>

  <footer id="footer" class="bg-slateBg text-slate-400 py-12 border-t border-slate-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
        <div class="col-span-1 md:col-span-1">
          <div class="flex items-center gap-2 text-white mb-4">
            <i data-lucide="plane" class="w-6 h-6 text-brand-500"></i>
            <span class="font-bold text-xl">TravelEase</span>
          </div>
          <p class="text-sm leading-relaxed text-slate-500">
            Making travel simple, affordable, and accessible for everyone. 
          </p>
        </div>
        <div>
          <h3 class="text-white font-semibold mb-4">Company</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="hover:text-white transition">About Us</a></li>
            <li><a href="#" class="hover:text-white transition">Careers</a></li>
            <li><a href="#" class="hover:text-white transition">Press</a></li>
          </ul>
        </div>
        <div>
          <h3 class="text-white font-semibold mb-4">Support</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="hover:text-white transition">Help Center</a></li>
            <li><a href="#" class="hover:text-white transition">Terms of Service</a></li>
            <li><a href="#" class="hover:text-white transition">Privacy Policy</a></li>
          </ul>
        </div>
        <div>
          <h3 class="text-white font-semibold mb-4">Contact</h3>
          <ul class="space-y-2 text-sm">
            <li class="flex items-center gap-2"><i data-lucide="mail" class="w-4 h-4"></i> hello@travelease.com</li>
            <li class="flex items-center gap-2"><i data-lucide="phone" class="w-4 h-4"></i> +91 98765 43210</li>
            <li class="flex items-center gap-2"><i data-lucide="map-pin" class="w-4 h-4"></i> Bangalore, India</li>
          </ul>
        </div>
      </div>
      <div class="border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between items-center text-xs">
        <p>&copy; 2025 TravelEase. All rights reserved.</p>
        <div class="flex gap-4 mt-4 md:mt-0">
          <i data-lucide="instagram" class="w-5 h-5 hover:text-white cursor-pointer transition"></i>
          <i data-lucide="twitter" class="w-5 h-5 hover:text-white cursor-pointer transition"></i>
          <i data-lucide="linkedin" class="w-5 h-5 hover:text-white cursor-pointer transition"></i>
        </div>
      </div>
    </div>
  </footer>

  <div id="booking-modal" class="fixed inset-0 z-[60] hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
      <div class="fixed inset-0 bg-slate-900 bg-opacity-75 transition-opacity backdrop-blur-sm" onclick="app.closeBooking()"></div>
      <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
      <div class="relative inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg w-full modal-enter">
        
        <div class="bg-brand-600 px-4 py-4 sm:px-6 flex justify-between items-center">
          <h3 class="text-lg leading-6 font-bold text-white flex items-center gap-2">
            <i data-lucide="check-circle" class="w-5 h-5"></i> Confirm Booking
          </h3>
          <button onclick="app.closeBooking()" class="text-brand-100 hover:text-white"><i data-lucide="x" class="w-5 h-5"></i></button>
        </div>

        <div class="px-4 py-5 sm:p-6 bg-slate-50">
          <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm mb-6 flex gap-4">
            <div class="w-16 h-16 rounded-lg bg-slate-100 flex-shrink-0 overflow-hidden">
               <img id="modal-img" src="" class="w-full h-full object-cover">
            </div>
            <div class="flex-1 min-w-0">
              <h4 class="text-sm font-bold text-slate-900 truncate" id="modal-title-text">Flight to Goa</h4>
              <p class="text-xs text-slate-500 mt-1" id="modal-subtitle">Air India • Economy</p>
              <div class="mt-2 flex items-baseline gap-1">
                <span class="text-lg font-bold text-brand-600" id="modal-price">$120</span>
                <span class="text-xs text-slate-400">/ person</span>
              </div>
            </div>
          </div>

          <form onsubmit="app.confirmBooking(event)" class="space-y-4">
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-xs font-semibold text-slate-500 uppercase mb-1">Travel Date</label>
                <input type="text" id="modal-date" class="w-full px-3 py-2 bg-slate-100 border border-slate-200 rounded-lg text-sm text-slate-600 cursor-not-allowed" readonly>
              </div>
              <div>
                <label class="block text-xs font-semibold text-slate-500 uppercase mb-1">Passengers</label>
                <input type="number" id="modal-pax" class="w-full px-3 py-2 bg-slate-100 border border-slate-200 rounded-lg text-sm text-slate-600 cursor-not-allowed" readonly>
              </div>
            </div>

            <div class="border-t border-slate-200 my-4"></div>

            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1">Passenger Name</label>
              <input type="text" id="pax-name" required class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 text-sm" placeholder="Name as on ID">
            </div>
            <div>
               <label class="block text-sm font-medium text-slate-700 mb-1">Mobile Number</label>
               <input type="tel" id="pax-phone" required class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 text-sm" placeholder="+91 98765 43210">
            </div>

            <button type="submit" class="w-full mt-2 bg-slate-900 text-white font-bold py-3 rounded-xl hover:bg-slate-800 transition shadow-lg shadow-slate-900/20 flex justify-center items-center gap-2">
              <span>Pay & Confirm</span>
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="fixed top-24 right-5 z-[70] transform transition-all duration-300 translate-x-64 opacity-0 flex items-center gap-3 bg-white border-l-4 border-emerald-500 px-6 py-4 shadow-xl rounded-r-lg">
    <div class="text-emerald-500"><i data-lucide="check-circle" class="w-6 h-6"></i></div>
    <div>
      <h4 class="font-bold text-slate-800 text-sm">Success</h4>
      <p class="text-slate-500 text-xs" id="toast-message">Operation successful</p>
    </div>
  </div>

  <script>
    // --- Mock Data ---
    const DB = {
      flights: [
        { id: 'f1', operator: 'IndiGo', code: '6E-554', time: '06:00 - 08:30', duration: '2h 30m', price: 4500, img: 'https://images.unsplash.com/photo-1436491865332-7a61a109cc05?auto=format&fit=crop&w=100&q=80' },
        { id: 'f2', operator: 'Air India', code: 'AI-402', time: '10:15 - 13:00', duration: '2h 45m', price: 5200, img: 'https://images.unsplash.com/photo-1570710891163-6d3b5c47248b?auto=format&fit=crop&w=100&q=80' },
        { id: 'f3', operator: 'Vistara', code: 'UK-890', time: '18:00 - 20:20', duration: '2h 20m', price: 6100, img: 'https://images.unsplash.com/photo-1559628230-0eb7504f4a9b?auto=format&fit=crop&w=100&q=80' },
        { id: 'f4', operator: 'Akasa Air', code: 'QP-112', time: '21:30 - 23:45', duration: '2h 15m', price: 3900, img: 'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?auto=format&fit=crop&w=100&q=80' },
      ],
      trains: [
        { id: 't1', operator: 'Vande Bharat', code: '22436', time: '06:00 - 14:00', duration: '8h 00m', price: 1850, img: 'https://images.unsplash.com/photo-1535535112387-56ffe8db21ff?auto=format&fit=crop&w=100&q=80' },
        { id: 't2', operator: 'Rajdhani Exp', code: '12951', time: '16:30 - 08:30', duration: '16h 00m', price: 2400, img: 'https://images.unsplash.com/photo-1474487548417-781cb71495f3?auto=format&fit=crop&w=100&q=80' },
        { id: 't3', operator: 'Shatabdi Exp', code: '12002', time: '06:10 - 12:40', duration: '6h 30m', price: 1200, img: 'https://images.unsplash.com/photo-1563911302283-d2bc129e7c1f?auto=format&fit=crop&w=100&q=80' },
        { id: 't4', operator: 'Duronto Exp', code: '12260', time: '12:20 - 07:15', duration: '18h 55m', price: 2100, img: 'https://images.unsplash.com/photo-1596733230588-f2b744eb8b8c?auto=format&fit=crop&w=100&q=80' }
      ],
      car: [
        { id: 'c1', operator: 'Uber Intercity', code: 'Sedan', time: 'Flexible', duration: 'Avg 50km/h', price: 12, img: 'https://images.unsplash.com/photo-1449965408869-eaa3f722e40d?auto=format&fit=crop&w=100&q=80' },
        { id: 'c2', operator: 'Ola Outstation', code: 'SUV', time: 'Flexible', duration: 'Avg 60km/h', price: 18, img: 'https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?auto=format&fit=crop&w=100&q=80' },
        { id: 'c3', operator: 'Zoomcar', code: 'Self Drive', time: '24 Hours', duration: 'Day Rate', price: 2500, img: 'https://images.unsplash.com/photo-1541899481282-d53bffe3c35d?auto=format&fit=crop&w=100&q=80' },
        { id: 'c4', operator: 'Savaari', code: 'Innova', time: 'Flexible', duration: 'Luxury', price: 22, img: 'https://images.unsplash.com/photo-1503376763036-066120622c74?auto=format&fit=crop&w=100&q=80' }
      ],
      hotel: [
        { id: 'h1', operator: 'The Oberoi', code: '5 Star', time: 'Check-in: 2PM', duration: 'Per Night', price: 14000, img: 'https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=100&q=80' },
        { id: 'h2', operator: 'Lemon Tree', code: 'Business', time: 'Check-in: 12PM', duration: 'Per Night', price: 4500, img: 'https://images.unsplash.com/photo-1582719508461-905c673771fd?auto=format&fit=crop&w=100&q=80' },
        { id: 'h3', operator: 'Zostel', code: 'Hostel', time: 'Check-in: 11AM', duration: 'Per Bed', price: 800, img: 'https://images.unsplash.com/photo-1555854743-6426e7419150?auto=format&fit=crop&w=100&q=80' },
        { id: 'h4', operator: 'Taj Resort', code: 'Luxury', time: 'Check-in: 2PM', duration: 'Per Night', price: 18000, img: 'https://images.unsplash.com/photo-1571896349842-68cfd4f9d4b6?auto=format&fit=crop&w=100&q=80' }
      ]
    };

    // --- Application State & Logic ---
    const app = {
      state: {
        mode: 'flight',
        user: null,
        currentItem: null,
        searchParams: {}
      },

      init() {
        this.loadUser();
        this.renderBookings();
        
        // Set default date to tomorrow
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        document.getElementById('input-date').valueAsDate = tomorrow;

        lucide.createIcons();
      },

      // --- Interaction ---
      setMode(mode) {
        this.state.mode = mode;
        
        // Update UI Tabs
        document.querySelectorAll('.search-tab').forEach(btn => {
          const btnMode = btn.getAttribute('data-mode');
          if (btnMode === mode) {
            btn.className = 'search-tab active-tab flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-semibold bg-white text-brand-600 shadow-sm transition-all';
          } else {
            btn.className = 'search-tab flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-semibold text-slate-500 hover:bg-white/50 transition-all';
          }
        });

        // Update Labels based on mode
        const labelFrom = document.getElementById('label-from');
        const labelTo = document.getElementById('label-to');
        const inputTo = document.getElementById('input-to');
        const fieldTo = document.getElementById('field-to');
        const btnText = document.getElementById('search-btn-text');

        if (mode === 'flight') {
          labelFrom.textContent = 'From (City/Airport)';
          labelTo.textContent = 'To (City/Airport)';
          fieldTo.style.display = 'block';
          inputTo.required = true;
          btnText.textContent = 'Search Flights';
        } else if (mode === 'train') {
          labelFrom.textContent = 'From Station';
          labelTo.textContent = 'To Station';
          fieldTo.style.display = 'block';
          inputTo.required = true;
          btnText.textContent = 'Search Trains';
        } else if (mode === 'car') {
          labelFrom.textContent = 'Pick-up Location';
          labelTo.textContent = 'Drop-off Location';
          fieldTo.style.display = 'block';
          inputTo.required = true;
          btnText.textContent = 'Find Cabs';
        } else if (mode === 'hotel') {
          labelFrom.textContent = 'City / Location';
          fieldTo.style.display = 'none';
          inputTo.required = false;
          btnText.textContent = 'Search Hotels';
        }
      },

      scrollTo(id) {
        document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
      },

      // --- Search ---
      handleSearch(e) {
        e.preventDefault();
        const from = document.getElementById('input-from').value;
        const to = document.getElementById('input-to').value;
        const date = document.getElementById('input-date').value;
        const pax = document.getElementById('input-pax').value;

        this.state.searchParams = { from, to, date, pax };

        // Simulate Loading
        const btn = e.target.querySelector('button');
        const originalText = btn.innerHTML;
        btn.innerHTML = `<i data-lucide="loader-2" class="w-5 h-5 animate-spin"></i> Searching...`;
        lucide.createIcons();

        setTimeout(() => {
          btn.innerHTML = originalText;
          lucide.createIcons();
          this.renderResults();
          document.getElementById('results-section').classList.remove('hidden');
          this.scrollTo('results-section');
        }, 800);
      },

      renderResults() {
        const grid = document.getElementById('results-grid');
        const modeData = DB[this.getModeKey()];
        const params = this.state.searchParams;

        let html = '';
        modeData.forEach(item => {
          // Adjust display based on mode
          let subText = item.time;
          let priceDisplay = `₹${item.price.toLocaleString()}`;
          if (this.state.mode === 'car') priceDisplay = `₹${item.price}/km`;
          
          html += `
            <div class="bg-white rounded-xl p-5 border border-slate-200 shadow-sm hover:shadow-card hover:border-brand-200 transition-all duration-300 group flex flex-col md:flex-row items-center gap-6 fade-in-up">
              <div class="flex items-center gap-4 w-full md:w-1/3">
                <div class="w-16 h-16 rounded-lg bg-slate-100 overflow-hidden flex-shrink-0">
                  <img src="${item.img}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                </div>
                <div>
                  <h3 class="font-bold text-slate-800 text-lg">${item.operator}</h3>
                  <p class="text-xs font-semibold text-slate-400 bg-slate-100 inline-block px-2 py-0.5 rounded">${item.code}</p>
                </div>
              </div>
              
              <div class="flex-1 w-full flex justify-between items-center px-0 md:px-6 border-t md:border-t-0 md:border-l md:border-r border-slate-100 py-4 md:py-0">
                <div class="text-center">
                   <p class="text-xs text-slate-400 font-medium">Departure</p>
                   <p class="font-bold text-slate-700">${subText.split('-')[0] || ''}</p>
                   <p class="text-xs text-slate-500 truncate max-w-[80px]">${params.from}</p>
                </div>
                <div class="flex flex-col items-center">
                   <p class="text-[10px] text-slate-400 mb-1">${item.duration}</p>
                   <div class="w-20 h-[1px] bg-slate-300 relative">
                     <div class="absolute -top-[3px] right-0 w-2 h-2 rounded-full bg-slate-300"></div>
                     <div class="absolute -top-[3px] left-0 w-2 h-2 rounded-full bg-slate-300"></div>
                   </div>
                   <i data-lucide="${this.getIconForMode()}" class="w-4 h-4 text-slate-300 mt-1"></i>
                </div>
                <div class="text-center">
                   <p class="text-xs text-slate-400 font-medium">Arrival</p>
                   <p class="font-bold text-slate-700">${subText.split('-')[1] || 'Check-out'}</p>
                   <p class="text-xs text-slate-500 truncate max-w-[80px]">${this.state.mode === 'hotel' ? params.from : params.to}</p>
                </div>
              </div>

              <div class="w-full md:w-auto text-right flex flex-row md:flex-col justify-between items-center gap-2">
                <div>
                  <p class="text-2xl font-bold text-slate-900">${priceDisplay}</p>
                  <p class="text-xs text-slate-400 hidden md:block">per person</p>
                </div>
                <button onclick="app.openBooking('${item.id}')" class="bg-brand-50 text-brand-700 border border-brand-200 hover:bg-brand-600 hover:text-white font-semibold py-2 px-6 rounded-lg transition-colors text-sm">
                  Book Now
                </button>
              </div>
            </div>
          `;
        });
        grid.innerHTML = html;
        lucide.createIcons();
      },

      getIconForMode() {
        switch(this.state.mode) {
          case 'flight': return 'plane';
          case 'train': return 'train';
          case 'car': return 'car';
          case 'hotel': return 'bed';
          default: return 'plane';
        }
      },

      // Map UI mode to DB keys (DB uses plural keys for flights/trains)
      getModeKey() {
        if (this.state.mode === 'flight') return 'flights';
        if (this.state.mode === 'train') return 'trains';
        return this.state.mode;
      },

      // --- Booking Flow ---
      openBooking(id) {
        // Ensure user is loaded (fallback to localStorage in case state wasn't initialized)
        if (!this.state.user) {
          const userStr = localStorage.getItem('travelEase_user');
          if (userStr) {
            try { this.state.user = JSON.parse(userStr); } catch (e) { this.state.user = null; }
          }
        }
        if (!this.state.user) {
          // Redirect to sign-in page
          window.location.href = 'signin.html';
          return;
        }

        const item = DB[this.getModeKey()]?.find(i => i.id === id);
        if (!item) return this.showToast('Selected item not found', 'error');
        this.state.currentItem = item;

        // Provide sensible defaults when search params are missing
        if (!this.state.searchParams || !this.state.searchParams.date) {
          const tomorrow = new Date();
          tomorrow.setDate(tomorrow.getDate() + 1);
          this.state.searchParams = this.state.searchParams || {};
          this.state.searchParams.date = tomorrow.toISOString().split('T')[0];
        }
        if (!this.state.searchParams.pax) this.state.searchParams.pax = 1;

        // Populate Modal
        document.getElementById('modal-img').src = item.img;
        document.getElementById('modal-title-text').textContent = item.operator;
        document.getElementById('modal-subtitle').textContent = `${this.state.mode.toUpperCase()} • ${item.code}`;
        document.getElementById('modal-price').textContent = `₹${item.price.toLocaleString()}`;
        document.getElementById('modal-date').value = this.state.searchParams.date;
        document.getElementById('modal-pax').value = this.state.searchParams.pax;

        // Show Modal
        document.getElementById('booking-modal').classList.remove('hidden');
      },

      closeBooking() {
        document.getElementById('booking-modal').classList.add('hidden');
      },

      confirmBooking(e) {
        e.preventDefault();
        const paxName = document.getElementById('pax-name').value;
        const booking = {
          id: Date.now(),
          ...this.state.currentItem,
          date: this.state.searchParams.date,
          pax: this.state.searchParams.pax,
          paxName: paxName,
          mode: this.state.mode,
          origin: this.state.searchParams.from,
          dest: this.state.searchParams.to
        };

        // FIXED: Using consistent storage key (travelEase_bookings)
        const bookings = JSON.parse(localStorage.getItem('travelEase_bookings') || '[]');
        bookings.unshift(booking);
        localStorage.setItem('travelEase_bookings', JSON.stringify(bookings));

        // Update UI
        this.closeBooking();
        this.renderBookings();
        this.showToast('Booking Confirmed!', 'success');
        this.scrollTo('mytrips');
        
        // Reset form
        e.target.reset();
      },

      renderBookings() {
        const container = document.getElementById('bookings-container');
        // FIXED: Using consistent storage key (travelEase_bookings)
        const bookings = JSON.parse(localStorage.getItem('travelEase_bookings') || '[]');

        if (bookings.length === 0) {
          // Restore default empty state HTML
          container.innerHTML = `
        <div class="text-center py-12 bg-slate-50 rounded-2xl border-2 border-dashed border-slate-200">
          <div class="mx-auto w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4">
            <i data-lucide="map" class="w-8 h-8 text-slate-300"></i>
          </div>
          <h3 class="text-lg font-medium text-slate-900">No trips booked yet</h3>
          <p class="text-slate-500 text-sm mt-1 mb-4">Time to start planning your next adventure!</p>
          <button onclick="app.scrollTo('hero')" class="text-brand-600 font-semibold hover:underline">Start Searching</button>
        </div>
          `;
          lucide.createIcons();
          return;
        }

        let html = '';
        bookings.forEach(b => {
           html += `
             <div class="bg-white rounded-xl border border-slate-200 p-5 shadow-sm flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 hover:border-brand-300 transition-colors">
               <div class="flex items-start gap-4">
                 <div class="w-12 h-12 rounded bg-brand-50 text-brand-600 flex items-center justify-center flex-shrink-0">
                    <i data-lucide="ticket" class="w-6 h-6"></i>
                 </div>
                 <div>
                   <h4 class="font-bold text-slate-800">${b.operator} <span class="text-xs font-normal text-slate-500 bg-slate-100 px-2 rounded-full ml-2">${b.mode.toUpperCase()}</span></h4>
                   <p class="text-sm text-slate-600 mt-0.5">${b.origin} ${b.mode !== 'hotel' ? '➝ ' + b.dest : ''}</p>
                   <p class="text-xs text-slate-400 mt-1">Travel Date: ${b.date} • ${b.pax} Passenger(s)</p>
                 </div>
               </div>
               <div class="flex items-center gap-4 w-full sm:w-auto justify-between sm:justify-end">
                 <div class="text-right">
                    <p class="font-bold text-slate-900">₹${b.price.toLocaleString()}</p>
                    <p class="text-xs text-emerald-600 font-medium">Confirmed</p>
                 </div>
                 <button onclick="app.cancelBooking('${b.id}')" class="text-slate-400 hover:text-red-500 p-2"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
               </div>
             </div>
           `;
        });
        container.innerHTML = html;
        lucide.createIcons();
      },

      cancelBooking(id) {
        if(!confirm('Are you sure you want to cancel this booking?')) return;
        // Compare IDs as strings to support alphanumeric IDs like 't2', 'f1'
        const idStr = String(id);
        let bookings = JSON.parse(localStorage.getItem('travelEase_bookings') || '[]');
        bookings = bookings.filter(b => String(b.id) !== idStr);
        localStorage.setItem('travelEase_bookings', JSON.stringify(bookings));
        this.renderBookings();
        this.showToast('Booking Cancelled', 'error');
      },

      // --- Auth ---
      loadUser() {
        // FIXED: Using consistent storage key (travelEase_user)
        const userStr = localStorage.getItem('travelEase_user');
        if (userStr) {
          this.state.user = JSON.parse(userStr);
          document.getElementById('user-name').textContent = this.state.user.name;
          document.getElementById('user-avatar').textContent = this.state.user.name.charAt(0).toUpperCase();
          document.getElementById('user-display').classList.remove('hidden');
          
          // Change "Sign In" to "Sign Out" and link to signout page
          const btn = document.getElementById('auth-btn');
          btn.textContent = 'Sign Out';
          btn.href = 'signout.html';
          btn.className = "text-xs font-semibold text-slate-500 hover:text-red-500 transition-colors ml-2";
        }
      },

      // --- Utilities ---
      showToast(message, type = 'success') {
        const toast = document.getElementById('toast');
        const msgEl = document.getElementById('toast-message');
        const iconEl = toast.querySelector('div:first-child');

        msgEl.textContent = message;
        if (type === 'error') {
          toast.classList.replace('border-emerald-500', 'border-red-500');
          iconEl.className = 'text-red-500';
          iconEl.innerHTML = '<i data-lucide="alert-circle" class="w-6 h-6"></i>';
        } else {
          toast.classList.replace('border-red-500', 'border-emerald-500');
          iconEl.className = 'text-emerald-500';
          iconEl.innerHTML = '<i data-lucide="check-circle" class="w-6 h-6"></i>';
        }

        toast.classList.remove('translate-x-64', 'opacity-0');
        lucide.createIcons();

        setTimeout(() => {
          toast.classList.add('translate-x-64', 'opacity-0');
        }, 3000);
      }
    };

    // --- Start App ---
    document.addEventListener('DOMContentLoaded', () => {
      app.init();
    });

  </script>
</body>
</html>
